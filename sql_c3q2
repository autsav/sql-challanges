
-- Question #6: 
-- How many order items of both business units (Nike Official and Nike Vintage) have been returned or cancelled,
-- and what is the total sales price in $ that has been impacted by it?

SELECT
    business_unit,
    COUNT(*) AS num_returned_or_cancelled,
    SUM(sale_price) AS total_sales_price_impacted
FROM 
(
    SELECT
        'Nike Official' AS business_unit,
        order_items.sale_price
    FROM
        order_items
    LEFT JOIN
    	orders
    ON
    	order_items.order_id = orders.order_id
    WHERE
        orders.status IN ('Returned', 'Cancelled')
    UNION ALL

  SELECT
        'Nike VINTAGE' AS business_unit,
        order_items_vintage.sale_price
    FROM
        order_items_vintage
    LEFT JOIN
    	orders
    ON
    	order_items_vintage.order_id = orders.order_id
    WHERE
        orders.status IN ('Returned', 'Cancelled')
) 
AS returned_or_cancelled_items
GROUP BY
    business_unit;

