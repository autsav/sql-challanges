
-- To create a summary of how many Nike Official order items have or have no discount applied for each product
-- and order the result per product name, you can use the following query:

SELECT
    products.product_name,
    COUNT(*) AS total_order_items,
    SUM(CASE WHEN products.retail_price > order_items.sale_price THEN 1 ELSE 0 END) AS discounted_items,
    SUM(CASE WHEN products.retail_price = order_items.sale_price THEN 1 ELSE 0 END) AS non_discounted_items
FROM
    products 
LEFT JOIN
    order_items  ON products.product_id = order_items.product_id 
GROUP BY
    products.product_name
ORDER BY
    products.product_name;

